import 'dart:io';

import 'package:bf_runner/bf.dart';
import 'package:flutter_test/flutter_test.dart';

void main() {
  test("hello ", () {
    final program =
        '++++++++++[>+++++++>++++++++++>+++>+<<<<-]>++.>+.+++++++..+++.>++.<<+++++++++++++++.>.+++.------.--------.>+.>.';
    final bfi = BFI();
    bfi.program = program;
    bfi.run();
    expect(bfi.out_s, "Hello World!\n");
  });
  test("input", () {
    final program =
        ">,>+++++++++,>+++++++++++[<++++++<++++++<+>>>-]<<.>.<<-.>.>.<<.";
    final bfi = BFI();
    bfi.program = program;
    bfi.input = List.from("\n".codeUnits);
    bfi.run();
    final res = bfi.out_s == "LB\nLB\n" ||
        bfi.out_s == "LK\nLK\n" ||
        bfi.out_s == "LA\nLA\n";
    print(bfi.out_s);
    expect(res, true);
  });
  test("big enough", () {
    final program =
        "++++[>++++++<-]>[>+++++>+++++++<<-]>>++++<[[>[[>>+<<-]<]>>>-]>-[>+>+<<-]>]+++++[>+++++++<<++>-]>.<<.";
    final bfi = BFI();
    bfi.program = program;
    bfi.run();
    print(bfi.out_s);
    expect(bfi.out_s, "#\n");
  });

  test("deep bracketts", () {
    final program =
        ",[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>++++++++++++++<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>>+++++[<----->-]<<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>++++++++++++++<-[>+<-[>+<-[>+<-[>+<-[>+<-[>++++++++++++++<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>>+++++[<----->-]<<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>+<-[>++++++++++++++<-[>+<-]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]>.[-]<,]";
    final bfi = BFI();
    bfi.program = program;
    bfi.input = List.from("~mlk zyx".codeUnits);
    bfi.run();
    expect(bfi.out_s, "~zyx mlk");
  });
}
